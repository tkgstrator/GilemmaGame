(function(t){function e(e){for(var a,s,o=e[0],l=e[1],u=e[2],h=0,f=[];h<o.length;h++)s=o[h],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&f.push(i[s][0]),i[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);c&&c(e);while(f.length)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,o=1;o<n.length;o++){var l=n[o];0!==i[l]&&(a=!1)}a&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var a={},i={app:0},r=[];function s(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=a,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(n,a,function(e){return t[e]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var c=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var a=n("8a23"),i=n.n(a);i.a},"06bf":function(t,e,n){},1:function(t,e){},10:function(t,e){},11:function(t,e){},12:function(t,e){},13:function(t,e){},14:function(t,e){},15:function(t,e){},"1e92":function(t,e,n){"use strict";var a=n("812f"),i=n.n(a);i.a},2:function(t,e){},2018:function(t,e,n){},3:function(t,e){},"3b33":function(t,e,n){"use strict";var a=n("9b97"),i=n.n(a);i.a},4:function(t,e){},5:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=n("2f62"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-container",[n("Top"),n("OAuth"),n("Timer"),n("Players"),n("Vote")],1)],1)},s=[],o=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},l=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"explanation"}},[n("div",{attrs:{id:"background"}},[n("h1",[t._v("ゲームの背景")]),n("p",[t._v(" あなたは見知らぬ部屋で目を覚ましました. ヒビが入ったコンクリートの壁に囲まれ, 先程まで寝ていた簡易ベッドと洗面所以外には何もありません. 無機質なその部屋は廃墟の病院のようにも思えました. あなたは脱出を試みましたが, 厚い金属板のドアにはロックがかかっているようです. ようやく悪意のある誰かに連れ去られ, この部屋に閉じ込められたことに気付いたあなたは外部への連絡を試みましたが, 普段ポケットに入っているはずのスマートフォンが見つかりません. 焦りつつも冷静なあなたは部屋の中を探索してみることにしました. するとダンボールに詰められたスティック状の携行食とミネラルウォーターが無造作においてあるのが目に付きました. どうやらあなたをここに閉じ込めた人物はあなたを餓死させるつもりはないようです. そのことに安堵しつつもどうやって脱出しようかと考えていた矢先, 不気味なアラートが耳に入りました. つられて腕を見ると見たことのない不思議なスマートウォッチのようなものが取り付けられ, メッセージが表示されていました. ")])]),n("div",{attrs:{id:"rule"}},[n("h1",[t._v("ゲームの説明")]),n("h2",[t._v(" おめでとうございます！ "),n("br"),t._v("あなたはゲームに参加する権利を得ました. ")]),n("p",[t._v("ゲームにクリアすればこの部屋から脱出することができます.")]),n("p",[t._v(" あなたの他にゲームに参加しているプレイヤーと交渉し, ポイントを稼ぐことが目的です. ")]),n("p",[t._v("ゲームクリア時にポイントと引き換えに賞金を手にすることができます.")]),n("p",[t._v(" １ターンは３分間でその間に腕のスマートウォッチで交渉が行なえます. ターン中であればいつでも交渉の選択を変えることができます. ")]),n("p",[t._v("１ターンごとに他のプレイヤーとの交渉の組み合わせによりプレイヤーのポイントが増減します.")]),n("p",[t._v(" ポイントをすべて失うと, ペナルティにより致死性の毒物がスマートウォッチから注入されゲームから離脱します. また, スマートウォッチを外すことはできません. ")])]),n("div",{attrs:{id:"negotiation"}},[n("h2",[t._v("他のプレイヤーとの交渉")]),n("p",[t._v("あなたは以下の３つの交渉の選択ができます.")]),n("h2",{staticClass:"command"},[t._v("沈黙")]),n("p",[t._v("プレイヤー数ｘ１０ｐｔを消費して他のプレイヤーの交渉を見守ります.")]),n("p",[t._v(" 協調が成立せず, 沈黙を選択したプレイヤーが半数以下の場合プレイヤー数ｘ２０ｐｔを獲得します. ")]),n("h2",{staticClass:"command"},[t._v("協調")]),n("p",[t._v("他のプレイヤーと協力し, ゲームクリアを目指します.")]),n("p",[t._v(" 半数以上が協調を選択した場合, 協調を選択したプレイヤー人数ｘ２０ｐｔを獲得します. ")]),n("p",[t._v("ただし, 裏切りが成立した場合はｐｔを獲得することができません.")]),n("h2",{staticClass:"command"},[t._v("裏切り")]),n("p",[t._v("協調しているプレイヤーを出し抜くことを試みます.")]),n("p",[t._v(" 協調が成立していれば, 協調を選択したプレイヤー人数ｘ２０ｐｔを獲得します. ")]),n("p",[t._v("裏切りが失敗した場合, 協調を選んだプレイヤー人数ｘ２０ｐｔを失います.")])])])}],u={},c=u,h=(n("599a"),n("2877")),f=Object(h["a"])(c,o,l,!1,null,null,null),d=f.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"twitter-signin"}},[this.$store.state.hash?n("div",{key:"login"},[n("li",{staticClass:"signout",on:{click:t.signOut}},[t._v("ゲームから離脱する")])]):n("div",{key:"logout"},[n("li",{staticClass:"signin",on:{click:t.signIn}},[t._v("ゲームに参加する")])])])},v=[],m=(n("d3b7"),n("25f0"),n("8aa5")),g=n.n(m),_=n("0ff2"),b=n("59ca"),y=n.n(b);n("e71f");a["a"].use(_["a"]);var w=y.a.initializeApp({apiKey:"AIzaSyDLtTk6gdcnZOcNfGv-TqH0422deqnOq3Y",authDomain:"dilemmagame-608cc.firebaseapp.com",databaseURL:"https://dilemmagame-608cc.firebaseio.com",projectId:"dilemmagame-608cc",storageBucket:"dilemmagame-608cc.appspot.com",messagingSenderId:"897994908936",appId:"1:897994908936:web:43349f53639b4afc71b8bd",measurementId:"G-QHMXKLB8EQ"}),x=w.firestore(),T={data:function(){return{vuid:null,user:{},players:[]}},created:function(){var t=this;g.a.auth().onAuthStateChanged((function(e){if(t.user=e||{},t.user.uid!=t.$store.state.uid){var a=n("1c46"),i=(new Date).getTime().toString(),r=a.createHash("sha256").update(i,"utf8").digest("hex");x.collection("users").doc(e.uid).set({name:e.displayName,hash:r,photo:e.photoURL,prev:null,next:null,value:0,playable:!0},{merge:!0}),t.$store.state.uid=t.user.uid,t.$store.state.hash=r}}))},methods:{signIn:function(){if(null==this.$store.state.uid){var t=new g.a.auth.TwitterAuthProvider;g.a.auth().signInWithPopup(t)}else{var e=n("1c46"),a=(new Date).getTime().toString(),i=e.createHash("sha256").update(a,"utf8").digest("hex");console.log("Calc New Hash:"+a+"=>"+i),this.$store.state.hash=i,x.collection("users").doc(this.user.uid).set({hash:i,playable:!0,value:0,prev:null,next:null},{merge:!0})}},signOut:function(){this.$store.state.hash=null,x.collection("users").doc(this.user.uid).update({playable:!1})},firestore:function(){return{players:x.collection("users").where("playable","==",!0)}}}},O=T,C=(n("b6da"),Object(h["a"])(O,p,v,!1,null,null,null)),$=C.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"playerstable"}},[n("table",{staticClass:"list content",attrs:{name:"players",tag:"div"}},t._l(t.players,(function(e,a){var i=e.name,r=e.value,s=e.prev,o=e.next,l=e.hash;return n("tr",{key:a,staticClass:"player",style:{color:l==t.vhash?"red":"black"}},[n("td",[t._v(t._s(i))]),n("td",[t._v(t._s(null==s?"未投票":t.type[s]))]),n("td",[t._v(t._s(null==o?"未投票":l==t.vhash?t.type[o]:"投票済"))]),n("td",[t._v(t._s(r))])])})),0)])},k=[],I=(n("4de4"),{name:"Players",data:function(){return{vhash:this.$store.state.hash,vuid:this.$store.state.uid,players:[],type:["沈黙","協調","裏切り"]}},watch:{players:{immediate:!0,handler:function(){if(null!=this.players){var t=this.players.filter((function(t){return 1==t["next"]}));if(t.length==this.players.length&&0!=this.players.length){var e=x.collection("rules").doc("mMNTKGPxpraq8z0KnCTB");e.get().then((function(t){t.exists&&(t.data()["mode"]||(x.collection("rules").doc("mMNTKGPxpraq8z0KnCTB").update({mode:!0,start_time:(new Date).getTime()}),console.log("Game Start")))}))}}}}},mounted:function(){var t=this;this.$store.watch((function(t,e){return e.hash}),(function(e){t.vhash=e}))},firestore:function(){return{players:x.collection("users").where("playable","==",!0)}}}),P=I,E=(n("74f1"),Object(h["a"])(P,j,k,!1,null,null,null)),S=E.exports,G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[1==this.$store.state.isHost?n("ul",{staticClass:"master"},[n("li",[t._v("Game Start")])]):t._e(),null!=this.$store.state.uid?n("ul",{staticClass:"negotiation"},[n("li",{on:{click:function(e){return t.onVote(0)}}},[t._v("沈黙")]),n("li",{on:{click:function(e){return t.onVote(1)}}},[t._v("協調")]),n("li",{on:{click:function(e){return t.onVote(2)}}},[t._v("裏切")])]):t._e()])},V=[],K=(n("a9e3"),{name:"Vote",data:function(){return{event:Number}},methods:{onVote:function(t){console.log(this.$store.state.uid,t),x.collection("users").doc(this.$store.state.uid).set({next:t},{merge:!0})}}}),M=K,R=(n("3b33"),Object(h["a"])(M,G,V,!1,null,null,null)),A=R.exports,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"counter"}},[null!=t.rule&&t.rule.mode?n("p",{staticClass:"timer",on:{click:function(e){return t.gameClear()}}},[t._v("第"+t._s(t.gameTurn)+"ターン 残り時間"+t._s(t.timeRemind)+"秒")]):n("p",{staticClass:"timer",on:{click:function(e){return t.showRule()}}},[t._v("プレイヤーの投票を待っています.")])])},N=[],q=(n("4160"),n("159b"),{name:"Timer",data:function(){return{rule:null,timeRemind:null,gameTurn:null,timerObj:null,start_time:null,players:[]}},watch:{rule:{immediate:!0,handler:function(){if(null!=this.rule&&null!=this.rule.start_time){this.start_time=this.rule.start_time;var t=parseInt(((new Date).getTime()-this.rule.start_time)/1e3);this.gameTurn=parseInt(t/30)+1,this.timeRemind=29-t%30,console.log("GameInfo:",this.gameTurn,this.timeRemind),this.timeStart()}}}},firestore:function(){return{rule:x.collection("rules").doc("mMNTKGPxpraq8z0KnCTB"),players:x.collection("users").where("playable","==",!0)}},methods:{timeStart:function(){if(null==this.timerObj){var t=this;this.timerObj=setInterval((function(){t.timeCount()}),1e3)}},timeCount:function(){var t=parseInt(((new Date).getTime()-this.start_time)/1e3);this.gameTurn=parseInt(t/30)+1,this.timeRemind=29-t%30,0==this.timeRemind&&this.calcValue()},gameClear:function(){console.log("Game Clear"),x.collection("rules").doc("mMNTKGPxpraq8z0KnCTB").update({mode:!1}),clearInterval(this.timerObj),this.timerObj=null},calcValue:function(){if(0!=this.players.length){if(console.log("GameInfo",this.players[0].id,this.$store.state.hash),this.players[0].hash==this.$store.state.hash){x.collection("users").where("next","==",null).get().then((function(t){t.forEach((function(t){x.collection("users").doc(t.id).update({playable:!1})}))}));var t=this.players.filter((function(t){return 0==t["next"]})).length,e=this.players.filter((function(t){return 1==t["next"]})).length,n=this.players.filter((function(t){return 2==t["next"]})).length,a=t+e+n;console.log("GameInfo",t,e,n),x.collection("users").get().then((function(t){t.forEach((function(t){var e=t.data()["next"];x.collection("users").doc(t.id).update({prev:e,next:null})}))})),x.collection("users").where("next","==",0).get().then((function(t){t.forEach((function(t){var e=t.data()["value"]-10*a;x.collection("users").doc(t.id).update({value:e})}))})),2*e>=a?0!=n?x.collection("users").where("next","==",2).get().then((function(t){t.forEach((function(t){var n=t.data()["value"]+20*e;x.collection("users").doc(t.id).update({value:n})}))})):x.collection("users").where("next","==",1).get().then((function(t){t.forEach((function(t){var n=t.data()["value"]+20*e;x.collection("users").doc(t.id).update({value:n})}))})):(0!=n&&x.collection("users").where("next","==",2).get().then((function(t){t.forEach((function(t){var n=t.data()["value"]-20*e;x.collection("users").doc(t.id).update({value:n})}))})),2*t<=a&&x.collection("users").where("next","==",0).get().then((function(t){t.forEach((function(t){var e=t.data()["value"]+20*a;x.collection("users").doc(t.id).update({value:e})}))})))}}else this.gameClear()}}}),D=q,z=(n("1e92"),Object(h["a"])(D,H,N,!1,null,null,null)),B=z.exports,L={name:"App",components:{OAuth:$,Top:d,Players:S,Vote:A,Timer:B}},U=L,J=(n("034f"),n("6544")),Q=n.n(J),W=n("7496"),X=n("a523"),Y=Object(h["a"])(U,r,s,!1,null,null,null),Z=Y.exports;Q()(Y,{VApp:W["a"],VContainer:X["a"]});var F=n("f309");a["a"].use(F["a"]);var tt=new F["a"]({});n("2018");a["a"].config.productionTip=!1,a["a"].use(i["a"]);var et=new i["a"].Store({state:{uid:null,hash:null},getters:{hash:function(t){return t.hash}},mutations:{setHash:function(t,e){t.hash=e.hash}},actions:{doUpdateHash:function(t,e){var n=t.commit;n("sethash",{hash:e})}}});new a["a"]({vuetify:tt,store:et,render:function(t){return t(Z)}}).$mount("#app")},"599a":function(t,e,n){"use strict";var a=n("a715"),i=n.n(a);i.a},6:function(t,e){},7:function(t,e){},"74f1":function(t,e,n){"use strict";var a=n("06bf"),i=n.n(a);i.a},8:function(t,e){},"812f":function(t,e,n){},"8a23":function(t,e,n){},9:function(t,e){},"9b97":function(t,e,n){},a715:function(t,e,n){},b6da:function(t,e,n){"use strict";var a=n("cfcc"),i=n.n(a);i.a},cfcc:function(t,e,n){}});
//# sourceMappingURL=app.300e849b.js.map